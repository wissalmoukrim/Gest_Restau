{% extends 'base.html.twig' %}

{% block title %}Modifier un plat{% endblock %}

{% block body %}
<div style="max-width: 600px; margin: 30px auto; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
    <h1 style="color: #333; border-bottom: 2px solid #FF9800; padding-bottom: 10px; margin-bottom: 20px;">
        ‚úèÔ∏è Modifier le plat
    </h1>
    
    {# D√âSACTIVE TURBO et ajoute enctype pour les fichiers #}
    {{ form_start(form, {'attr': {'data-turbo': 'false', 'enctype': 'multipart/form-data'}}) }}
    
    <div style="margin-bottom: 20px;">
        {{ form_label(form.nom) }}
        {{ form_widget(form.nom, {'attr': {'class': 'form-control'}}) }}
    </div>
    
    <div style="margin-bottom: 20px;">
        {{ form_label(form.description) }}
        {{ form_widget(form.description, {'attr': {'class': 'form-control', 'rows': 4}}) }}
    </div>
    
    <div style="margin-bottom: 20px;">
        {{ form_label(form.prix) }}
        <div style="display: flex; align-items: center;">
            {{ form_widget(form.prix, {'attr': {'class': 'form-control', 'style': 'flex: 1;'}}) }}
            <span style="margin-left: 10px; font-weight: bold; color: #666;">DH</span>
        </div>
    </div>
    
    <div style="margin-bottom: 20px; display: flex; align-items: center;">
        {{ form_widget(form.disponible, {'attr': {'style': 'margin-right: 10px;'}}) }}
        {{ form_label(form.disponible) }}
    </div>
    
    <div style="margin-bottom: 25px;">
        {{ form_label(form.image) }}
        {{ form_widget(form.image, {'attr': {'class': 'form-control'}}) }}
        
        {# V√©rifie si l'entit√© plat est accessible via form.vars.value #}
        {% set currentPlat = form.vars.value %}
        {% if currentPlat and currentPlat.image %}
            <div style="margin-top: 10px;">
                <p style="margin: 5px 0; color: #666;">Image actuelle:</p>
                <img src="{{ asset('uploads/' ~ currentPlat.image) }}" 
                     alt="{{ currentPlat.nom }}" 
                     style="max-width: 200px; max-height: 150px; border-radius: 4px; border: 1px solid #ddd;">
            </div>
        {% endif %}
    </div>
    
    <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee;">
        <button type="submit" 
                style="background: #FF9800; color: white; border: none; padding: 12px 30px; 
                       border-radius: 4px; cursor: pointer; font-size: 16px; font-weight: bold;
                       transition: background 0.3s;"
                onmouseover="this.style.background='#F57C00'"
                onmouseout="this.style.background='#FF9800'">
            üíæ Enregistrer les modifications
        </button>
        
        <a href="{{ path('app_admin_plat') }}" 
           style="margin-left: 15px; color: #666; text-decoration: none; padding: 12px 20px;
                  border: 1px solid #ddd; border-radius: 4px; display: inline-block;">
            ‚Ü© Retour √† la liste
        </a>
    </div>
    
    {{ form_end(form) }}
</div>

<style>
    .form-control {
        width: 100%;
        padding: 10px 12px;
        margin: 8px 0 5px 0;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 16px;
        box-sizing: border-box;
    }
    
    .form-control:focus {
        border-color: #FF9800;
        outline: none;
        box-shadow: 0 0 5px rgba(255, 152, 0, 0.3);
    }
    
    label {
        font-weight: bold;
        color: #555;
        margin-bottom: 5px;
        display: block;
    }
</style>
{% endblock %}